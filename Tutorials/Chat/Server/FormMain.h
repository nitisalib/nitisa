#pragma once

#include "IFormMain.h" // Include form file generated by Form Builder

namespace nitisa
{
	namespace app
	{
		class CFormMain :public IFormMain // Class declaration for application's form
		{
		private:
			struct MESSAGE // Describe message from user
			{
				int Id; // Message identifier
				String User; // Name of user who send the message
				String Message; // Message text
			};

			std::vector<MESSAGE> m_aMessages; // List of all messages
			StringArray m_aLogs; // List of messages to be added to memo showing the log
			std::mutex m_sSync; // Synchronization object
		protected:
			// Event processing methods copied from IFormMain and declared as overrided
			void ButtonStart_OnClick(IControl *sender) override;
			void ButtonStop_OnClick(IControl *sender) override;
			void Timer_OnTimer(IComponent *sender) override;
			void TCPServer_OnClientHaveData(standard::ITCPServer *sender, standard::ITCPServer::IClient *client, bool &disconnect) override;
		public:
			CFormMain(); // Constructor
		};
	}
}